
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for setting up a Shelly Dimmer 2.">
<meta itemprop="name" content="Shelly Dimmer">
<meta itemprop="description" content="Instructions for setting up a Shelly Dimmer 2.">
<meta itemprop="image" content="https://clydebarrow.github.io/esphome-docs/_images/shellydimmer2.jpg">
<meta name="twitter:title" content="Shelly Dimmer">
<meta name="twitter:image:src" content="https://clydebarrow.github.io/esphome-docs/_images/shellydimmer2.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up a Shelly Dimmer 2.">
<meta property="og:title" content="Shelly Dimmer">
<meta property="og:image" content="https://clydebarrow.github.io/esphome-docs/_images/shellydimmer2.jpg">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for setting up a Shelly Dimmer 2.">

    <title>Shelly Dimmer &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="canonical" href="https://clydebarrow.github.io/esphome-docs/components/light/shelly_dimmer.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sonoff D1 Dimmer" href="sonoff_d1.html" />
    <link rel="prev" title="RP2040 PIO LED Strip" href="rp2040_pio_led_strip.html" />
  <link rel="stylesheet" href="../../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
  <link rel="manifest" href="_static/site.webmanifest">
  <link rel="mask-icon" href="_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="pagefind/pagefind-ui.css" rel="stylesheet">
<script src="pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Shelly Dimmer</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="../index.html">Components</a> ‚ûî</li>
      <li><a href="index.html">Light Component</a> ‚ûî</li>
      <li>Shelly Dimmer</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="shelly-dimmer">
<h1>Shelly Dimmer<a class="headerlink" href="#shelly-dimmer" title="Permalink to this heading">¬∂</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">shelly_dimmer</span></code> component adds support for the dimming and power-metering functionality that can be found the <a class="reference external" href="https://shelly.cloud/knowledge-base/devices/shelly-dimmer-2/">Shelly Dimmer 2</a>. The interaction with mains is done via an STM32 microcontroller that is automatically (when configured) flashed with an <a class="reference external" href="https://github.com/jamesturton/shelly-dimmer-stm32">open source firmware</a>.
A detailed analysis of the Shelly Dimmer 2 hardware is given <a class="reference external" href="https://github.com/arendst/Tasmota/issues/6914">here</a>.</p>
<p>Warning!!! At the time of writing there seems to be no way to revert back to the ‚Äústock firmware‚Äù, because there seems to be no way to revert to firmware of the STM32 co-processor.</p>
<p>The</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/shellydimmer2.jpg"><img alt="../../_images/shellydimmer2.jpg" src="../../_images/shellydimmer2.jpg" style="width: 40.0%;" /></a>
</figure>
<p>An example of a configuration of this component:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">logger</span><span class="p">:</span>
<span class="w">    </span><span class="nt">baud_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>

<span class="nt">uart</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tx_pin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">rx_pin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">baud_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">115200</span>
<span class="nt">sensor</span><span class="p">:</span>

<span class="nt">light</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">shelly_dimmer</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Shelly Dimmer 2 Light</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">thislight</span>
<span class="w">      </span><span class="nt">power</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Shelly Dimmer 2 Light Power</span>
<span class="w">      </span><span class="nt">voltage</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Shelly Dimmer 2 Light Voltage</span>
<span class="w">      </span><span class="nt">current</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Shelly Dimmer 2 Light Current</span>
<span class="w">      </span><span class="nt">max_brightness</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">      </span><span class="nt">firmware</span><span class="p">:</span>
<span class="w">        </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;51.6&quot;</span>
<span class="w">        </span><span class="nt">update</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<section id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this heading">¬∂</a></h2>
<ul class="simple">
<li><p><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify the ID used for code generation.</p></li>
<li><p><strong>uart_id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify the ID of the UART hub.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently, only the first hardware UART of the ESP is supported, which has to be configured like this:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">uart</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tx_pin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">rx_pin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">    </span><span class="nt">baud_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">115200</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p><strong>name</strong> (<strong>Required</strong>, string): The name of the light.</p></li>
<li><p><strong>leading_edge</strong> (<em>Optional</em>, boolean): <a class="reference external" href="https://en.wikipedia.org/wiki/Dimmer#Solid-state_dimmer">Dimming mode</a>: <code class="docutils literal notranslate"><span class="pre">true</span></code> means leading edge, <code class="docutils literal notranslate"><span class="pre">false</span></code> is trailing edge. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p><strong>min_brightness</strong> (<em>Optional</em>, int): Minimum brightness value on a scale from 0..1000, the default is 0.</p></li>
<li><p><strong>max_brightness</strong> (<em>Optional</em>, int): Maximum brightness value on a scale from 0..1000, the default is 1000.</p></li>
<li><p><strong>warmup_brightness</strong> (<em>Optional</em>, int): Brightness threshold below which the dimmer switches on later in mains current cycle. <a class="reference external" href="https://github.com/jamesturton/shelly-dimmer-stm32/pull/23">This might help with dimming LEDs</a>. The value is from 0..1000 with an default of 0.</p></li>
<li><p><strong>nrst_pin</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin"><span class="std std-ref">Pin</span></a>): Pin connected with ‚ÄúNRST‚Äù of STM32. The  default is ‚ÄúGPIO5‚Äù.</p></li>
<li><p><strong>boot0_pin</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin"><span class="std std-ref">Pin</span></a>): Pin connected with ‚ÄúBOOT0‚Äù of STM32. The  default is ‚ÄúGPIO4‚Äù.</p></li>
<li><p><strong>current</strong> (<em>Optional</em>): Sensor of the current in Amperes. All options from
<a class="reference internal" href="../sensor/index.html#config-sensor"><span class="std std-ref">Sensor</span></a>.</p></li>
<li><p><strong>voltage</strong> (<em>Optional</em>): Sensor of the voltage in Volts. Only accurate if neutral is connected. All options from <a class="reference internal" href="../sensor/index.html#config-sensor"><span class="std std-ref">Sensor</span></a>.</p></li>
<li><p><strong>power</strong> (<em>Optional</em>): Sensor of the active power in Watts. Only accurate if neutral is connected. All options from <a class="reference internal" href="../sensor/index.html#config-sensor"><span class="std std-ref">Sensor</span></a>.</p></li>
<li><p><strong>firmware</strong> (<em>Optional</em>):</p>
<ul>
<li><p><strong>version</strong> (<em>Optional</em>): Version string of the <a class="reference external" href="https://github.com/jamesturton/shelly-dimmer-stm32">firmware</a> that will be expected on the microcontroller. The default is ‚Äú51.6‚Äù, another known-good firmware is ‚Äú51.5‚Äù.</p></li>
<li><p><strong>url</strong> (<em>Optional</em>, string): An URL to download the firmware from. Defaults to github for known firmware versions.</p></li>
<li><p><strong>sha256</strong> (<em>Optional</em>): A hash to compare the downloaded firmware against. Defaults a proper hash of known firmware versions.</p></li>
<li><p><strong>update</strong> (<em>Optional</em>): Should the firmware of the STM be updated if necessary? The default is false.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When flashing Shelly Dimmer with esphome for the first time, automatic flashing the STM firmware is necessary too for the dimmer to work and enabled by the following configuration.:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">firmware</span><span class="p">:</span>
<span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;51.6&quot;</span><span class="w"> </span><span class="c1">#&lt;-- set version here</span>
<span class="w">  </span><span class="nt">update</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>There is no action required by the user to flash the STM32. There is no way to revert to stock firmware on the STM32 at the time of writing.</p>
</div>
<ul class="simple">
<li><p>All other options from <a class="reference internal" href="index.html#config-light"><span class="std std-ref">Light</span></a>.</p></li>
</ul>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">¬∂</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="index.html"><span class="doc">Light Component</span></a></p></li>
<li><p><a class="reference external" href="/api/shelly__dimmer_8h.html">API Reference</a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/components/light/shelly_dimmer.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 üéâ
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>