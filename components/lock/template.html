
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for setting up template locks that can execute arbitrary actions when locked, unlocked, or opened">
<meta itemprop="name" content="Template Lock">
<meta itemprop="description" content="Instructions for setting up template locks that can execute arbitrary actions when locked, unlocked, or opened">
<meta itemprop="image" content="https://esphome.io/_images/description.png">
<meta name="twitter:title" content="Template Lock">
<meta name="twitter:image:src" content="https://esphome.io/_images/description.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up template locks that can execute arbitrary actions when locked, unlocked, or opened">
<meta property="og:title" content="Template Lock">
<meta property="og:image" content="https://esphome.io/_images/description.png">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for setting up template locks that can execute arbitrary actions when locked, unlocked, or opened">

    <title>Template Lock &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="canonical" href="https://esphome.io/components/lock/template.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Display Menu" href="../display_menu/index.html" />
    <link rel="prev" title="Generic Output Lock" href="output.html" />
  <link rel="stylesheet" href="../../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="/_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="/_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="/_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="/_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/_static/favicon-16x16.png">
  <link rel="manifest" href="/_static/site.webmanifest">
  <link rel="mask-icon" href="/_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="/_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Template Lock</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#lock-template-publish-action"><code class="docutils literal notranslate"><span class="pre">lock.template.publish</span></code> Action</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="../index.html">Components</a> ➔</li>
      <li><a href="index.html">Lock Component</a> ➔</li>
      <li>Template Lock</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="template-lock">
<h1>Template Lock<a class="headerlink" href="#template-lock" title="Permalink to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">template</span></code> lock platform allows you to create simple locks out of just actions and
an optional value lambda. Once defined, it will automatically appear in Home Assistant
as a lock and can be controlled through the frontend.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">lock</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Template</span><span class="nv"> </span><span class="s">Lock&quot;</span>
<span class="w">    </span><span class="nt">lambda</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">      </span><span class="no">if (id(some_binary_sensor).state) {</span>
<span class="w">        </span><span class="no">return LOCK_STATE_LOCKED;</span>
<span class="w">      </span><span class="no">} else {</span>
<span class="w">        </span><span class="no">return LOCK_STATE_UNLOCKED;</span>
<span class="w">      </span><span class="no">}</span>
<span class="w">    </span><span class="nt">lock_action</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">switch.turn_on</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">switch1</span>
<span class="w">    </span><span class="nt">unlock_action</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">switch.turn_off</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">switch1</span>
<span class="w">    </span><span class="nt">open_action</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">button.press</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">button1</span>
</pre></div>
</div>
<p>Possible return values for the optional lambda:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">LOCK_STATE_LOCKED;</span></code> if the lock should be reported as LOCKED.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">LOCK_STATE_UNLOCKED;</span></code> if the lock should be reported as UNLOCKED.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">LOCK_STATE_JAMMED;</span></code> if the lock should be reported as JAMMED.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">LOCK_STATE_LOCKING;</span></code> if the lock should be reported as LOCKING.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">LOCK_STATE_UNLOCKING;</span></code> if the lock should be reported as UNLOCKING.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">{};</span></code> if the last state should be repeated.</p></li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only <code class="docutils literal notranslate"><span class="pre">LOCK_STATE_LOCKED</span></code> and <code class="docutils literal notranslate"><span class="pre">LOCK_STATE_UNLOCKED</span></code> are supported by the MQTT component in Home Assistant</p>
</div>
<section id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>name</strong> (<strong>Required</strong>, string): The name of the lock.</p></li>
<li><p><strong>lambda</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/automations.html#config-lambda"><span class="std std-ref">lambda</span></a>):
Lambda to be evaluated repeatedly to get the current state of the lock.</p></li>
<li><p><strong>lock_action</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/automations.html#config-action"><span class="std std-ref">Action</span></a>): The action that should
be performed when the remote (like Home Assistant’s frontend) requests the lock to be locked.</p></li>
<li><p><strong>unlock_action</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/automations.html#config-action"><span class="std std-ref">Action</span></a>): The action that should
be performed when the remote (like Home Assistant’s frontend) requests the lock to be unlocked.</p></li>
<li><p><strong>optimistic</strong> (<em>Optional</em>, boolean): Whether to operate in optimistic mode - when in this mode,
any command sent to the template lock will immediately update the reported state.
Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p><strong>assumed_state</strong> (<em>Optional</em>, boolean): Whether the true state of the lock is not known.
This will make the Home Assistant frontend show buttons for both LOCK and UNLOCK actions, instead
of hiding one of them when the lock is LOCKED/UNLOCKED. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify the ID used for code generation.</p></li>
<li><p>All other options from <a class="reference internal" href="index.html#config-lock"><span class="std std-ref">Lock</span></a>.</p></li>
</ul>
</section>
<section id="lock-template-publish-action">
<span id="id1"></span><h2><code class="docutils literal notranslate"><span class="pre">lock.template.publish</span></code> Action<a class="headerlink" href="#lock-template-publish-action" title="Permalink to this heading">¶</a></h2>
<p>You can also publish a state to a template lock from elsewhere in your YAML file
with the <code class="docutils literal notranslate"><span class="pre">lock.template.publish</span></code> action.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">lock</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Template</span><span class="nv"> </span><span class="s">Lock&quot;</span>
<span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template_lock1</span>

<span class="c1"># in some trigger</span>
<span class="nt">on_...</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">lock.template.publish</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template_lock1</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOCK_STATE_LOCKED</span>

<span class="w">  </span><span class="c1"># Templated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">lock.template.publish</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template_lock1</span>
<span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="kt">!lambda</span><span class="w"> </span><span class="s">&#39;return</span><span class="nv"> </span><span class="s">LOCK_STATE_LOCKED;&#39;</span>
</pre></div>
</div>
<p>Configuration options:</p>
<ul class="simple">
<li><p><strong>id</strong> (<strong>Required</strong>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): The ID of the template lock.</p></li>
<li><p><strong>state</strong> (<strong>Required</strong>, boolean, <a class="reference internal" href="../../guides/automations.html#config-templatable"><span class="std std-ref">templatable</span></a>):
The state to publish.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This action can also be written in lambdas, the parameter of the <cite>publish_state</cite> method denotes the state the
lock should become:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">id</span><span class="p">(</span><span class="n">template_lock1</span><span class="p">).</span><span class="n">publish_state</span><span class="p">(</span><span class="n">lock</span><span class="o">::</span><span class="n">LOCK_STATE_LOCKED</span><span class="p">);</span>
</pre></div>
</div>
</div>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../../guides/automations.html"><span class="doc">Automations and Templates</span></a></p></li>
<li><p><a class="reference internal" href="index.html"><span class="doc">Lock Component</span></a></p></li>
<li><p><a class="reference internal" href="../binary_sensor/index.html"><span class="doc">Binary Sensor Component</span></a></p></li>
<li><p><a class="reference external" href="/api/template__lock_8h.html">API Reference</a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/components/lock/template.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 🎉
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="/changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("/changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>