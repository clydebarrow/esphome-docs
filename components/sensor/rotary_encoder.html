
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for setting up rotary encoders.">
<meta itemprop="name" content="Rotary Encoder Sensor">
<meta itemprop="description" content="Instructions for setting up rotary encoders.">
<meta itemprop="image" content="https://clydebarrow.github.io/esphome-docs/_images/rotary_encoder.jpg">
<meta name="twitter:title" content="Rotary Encoder Sensor">
<meta name="twitter:image:src" content="https://clydebarrow.github.io/esphome-docs/_images/rotary_encoder.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up rotary encoders.">
<meta property="og:title" content="Rotary Encoder Sensor">
<meta property="og:image" content="https://clydebarrow.github.io/esphome-docs/_images/rotary_encoder.jpg">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for setting up rotary encoders.">

    <title>Rotary Encoder Sensor &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="canonical" href="https://clydebarrow.github.io/esphome-docs/components/sensor/rotary_encoder.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="RuuviTag Open Source BLE Sensor" href="ruuvitag.html" />
    <link rel="prev" title="Resistance Sensor" href="resistance.html" />
  <link rel="stylesheet" href="../../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
  <link rel="manifest" href="_static/site.webmanifest">
  <link rel="mask-icon" href="_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="pagefind/pagefind-ui.css" rel="stylesheet">
<script src="pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Rotary Encoder Sensor</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#sensor-rotary-encoder-set-value-action"><code class="docutils literal notranslate"><span class="pre">sensor.rotary_encoder.set_value</span></code> Action</a></li>
<li><a class="reference internal" href="#on-clockwise-and-on-anticlockwise-triggers"><code class="docutils literal notranslate"><span class="pre">on_clockwise</span></code> and <code class="docutils literal notranslate"><span class="pre">on_anticlockwise</span></code> Triggers</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="../index.html">Components</a> ➔</li>
      <li><a href="index.html">Sensor Component</a> ➔</li>
      <li>Rotary Encoder Sensor</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="rotary-encoder-sensor">
<h1>Rotary Encoder Sensor<a class="headerlink" href="#rotary-encoder-sensor" title="Permalink to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">rotary_encoder</span></code> sensor platform allows you to use any continuous-rotation
rotary encoders with ESPHome. These devices usually have two pins with which
they encode the rotation. Every time the knob of the rotary encoder is turned, the
signals of the two pins go HIGH and LOW in turn. See
<a class="reference external" href="https://playground.arduino.cc/Main/RotaryEncoders">this Arduino article</a> to gain
a better understanding of these sensors.</p>
<figure class="align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/rotary_encoder1.jpg"><img alt="../../_images/rotary_encoder1.jpg" src="../../_images/rotary_encoder1.jpg" style="width: 75.0%;" /></a>
<figcaption>
<p><span class="caption-text">Example of a continuous rotary encoder. Pin <code class="docutils literal notranslate"><span class="pre">+</span></code> is connected to <code class="docutils literal notranslate"><span class="pre">3.3V</span></code>,
<code class="docutils literal notranslate"><span class="pre">GND</span></code> is connected to <code class="docutils literal notranslate"><span class="pre">GND</span></code>, and <code class="docutils literal notranslate"><span class="pre">CLK</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">DT</span></code> are A &amp; B.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/rotary_encoder-ui.png"><img alt="../../_images/rotary_encoder-ui.png" src="../../_images/rotary_encoder-ui.png" style="width: 75.0%;" /></a>
</figure>
<p>To use rotary encoders in ESPHome, first identify the two pins encoding the step value.
These are often called <code class="docutils literal notranslate"><span class="pre">CLK</span></code> and <code class="docutils literal notranslate"><span class="pre">DT</span></code> as in above image. Note if the values this sensor
outputs go in the wrong direction, you can just swap these two pins.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rotary_encoder</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Rotary</span><span class="nv"> </span><span class="s">Encoder&quot;</span>
<span class="w">    </span><span class="nt">pin_a</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">D1</span>
<span class="w">    </span><span class="nt">pin_b</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">D2</span>
</pre></div>
</div>
<p>To modify additional parameters of pins like active state or pull-ups, you may add extra options.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of advanced pin configuration</span>
<span class="nt">pin_a</span><span class="p">:</span>
<span class="w">  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">D5</span>
<span class="w">  </span><span class="nt">inverted</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">mode</span><span class="p">:</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">pullup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
<section id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p><strong>pin_a</strong> (<strong>Required</strong>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin-schema"><span class="std std-ref">Pin Schema</span></a>):
The first pin for determining the step value. Must not be a pin from an external I/O expander.</p></li>
<li><p><strong>pin_b</strong> (<strong>Required</strong>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin-schema"><span class="std std-ref">Pin Schema</span></a>):
The second pin for determining the step value. Must not be a pin from an external I/O expander.</p></li>
<li><p><strong>name</strong> (<strong>Required</strong>, string): The name of the rotary encoder sensor.</p></li>
<li><p><strong>pin_reset</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-pin-schema"><span class="std std-ref">Pin Schema</span></a>):
An optional pin that resets the step value. This is useful with rotary encoders that have a
third pin. Defaults to no reset pin.</p></li>
<li><p><strong>resolution</strong> (<em>Optional</em>, string): The resolution of the sensor, this controls how many
pulses are generated by one step:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - (Default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code></p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify the ID used for code generation.</p></li>
<li><p><strong>min_value</strong> (<em>Optional</em>, int): The minimum value this rotary encoder will go to, turning
the knob further will not decrease the number. Defaults to no minimum.</p></li>
<li><p><strong>max_value</strong> (<em>Optional</em>, int): The maximum value this rotary encoder will go to, turning
the knob further will not increase the number. Defaults to no maximum.</p></li>
<li><p><strong>publish_initial_value</strong> (<em>Optional</em>, boolean): Controls whether the value is published
upon start of ESPHome. By default, the value is only published when it changes, causing an
“unknown” value at first. If you set this option to true, the value is published once after
boot and when it changes. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p><strong>restore_mode</strong> (<em>Optional</em>): Control how the Rotary Encoder attempts to restore state on bootup.
For restoring on ESP8266s, also see <code class="docutils literal notranslate"><span class="pre">esp8266_restore_from_flash</span></code> in the
<a class="reference internal" href="../esphome.html"><span class="doc">esphome section</span></a>.</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RESTORE_DEFAULT_ZERO</span></code> - (Default) Attempt to restore state and default to zero (0) if not possible to restore.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ALWAYS_ZERO</span></code> - Always initialize the counter with value zero (0).</p></li>
</ul>
</div></blockquote>
</li>
<li><p><strong>on_clockwise</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>): Actions to be performed when
the knob is turned clockwise. See <a class="reference internal" href="#sensor-rotary-encoder-triggers"><span class="std std-ref">on_clockwise and on_anticlockwise Triggers</span></a>.</p></li>
<li><p><strong>on_anticlockwise</strong> (<em>Optional</em>, <a class="reference internal" href="../../guides/automations.html#automation"><span class="std std-ref">Automation</span></a>): Actions to be performed when
the knob is turned anticlockwise. See <a class="reference internal" href="#sensor-rotary-encoder-triggers"><span class="std std-ref">on_clockwise and on_anticlockwise Triggers</span></a>.</p></li>
<li><p>All other options from <a class="reference internal" href="index.html#config-sensor"><span class="std std-ref">Sensor</span></a>.</p></li>
</ul>
</section>
<section id="sensor-rotary-encoder-set-value-action">
<span id="id1"></span><h2><code class="docutils literal notranslate"><span class="pre">sensor.rotary_encoder.set_value</span></code> Action<a class="headerlink" href="#sensor-rotary-encoder-set-value-action" title="Permalink to this heading">¶</a></h2>
<p>The internal state of the rotary encoder can be manually changed to any value with this action.
After executing this action, rotating the encoder further will increase/decrease the state relative
to the newly set internal value.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rotary_encoder</span>
<span class="w">    </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_rotary_encoder</span>
<span class="w">    </span><span class="c1"># ...</span>

<span class="c1"># in some trigger</span>
<span class="nt">on_...</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">sensor.rotary_encoder.set_value</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_rotary_encoder</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">  </span><span class="c1"># Templated</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">sensor.rotary_encoder.set_value</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_rotary_encoder</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="kt">!lambda</span><span class="w"> </span><span class="s">&#39;return</span><span class="nv"> </span><span class="s">-1;&#39;</span>
</pre></div>
</div>
<p>Configuration options:</p>
<ul class="simple">
<li><p><strong>id</strong> (<strong>Required</strong>, <a class="reference internal" href="../../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): The ID of the rotary encoder.</p></li>
<li><p><strong>value</strong> (<strong>Required</strong>, int, <a class="reference internal" href="../../guides/automations.html#config-templatable"><span class="std std-ref">templatable</span></a>):
The value to set the internal counter to.</p></li>
</ul>
</section>
<section id="on-clockwise-and-on-anticlockwise-triggers">
<span id="sensor-rotary-encoder-triggers"></span><h2><code class="docutils literal notranslate"><span class="pre">on_clockwise</span></code> and <code class="docutils literal notranslate"><span class="pre">on_anticlockwise</span></code> Triggers<a class="headerlink" href="#on-clockwise-and-on-anticlockwise-triggers" title="Permalink to this heading">¶</a></h2>
<p>With these configuration options, you can run automations based on the direction
that the encoder has been turned, and not the value that it currently holds.
These triggers ignore the min and max values and will trigger on every step.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">on_clockwise</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">logger.log</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Turned</span><span class="nv"> </span><span class="s">Clockwise&quot;</span>
<span class="nt">on_anticlockwise</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">logger.log</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Turned</span><span class="nv"> </span><span class="s">Anticlockwise&quot;</span>
</pre></div>
</div>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#sensor-filters"><span class="std std-ref">Sensor Filters</span></a></p></li>
<li><p><a class="reference internal" href="pulse_counter.html"><span class="doc">Pulse Counter Sensor</span></a></p></li>
<li><p><a class="reference internal" href="template.html"><span class="doc">Template Sensor</span></a></p></li>
<li><p><a class="reference external" href="https://github.com/jkDesignDE/MechInputs">Mechanical Input Library</a> by <a class="reference external" href="https://github.com/JK-de">Jochen Krapf</a></p></li>
<li><p><a class="reference external" href="/api/rotary__encoder_8h.html">API Reference</a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/components/sensor/rotary_encoder.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 🎉
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>