
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for setting up a prometheus exporter with ESPHome.">
<meta itemprop="name" content="Prometheus Component">
<meta itemprop="description" content="Instructions for setting up a prometheus exporter with ESPHome.">
<meta itemprop="image" content="https://clydebarrow.github.io/esphome-docs/_images/prometheus.png">
<meta name="twitter:title" content="Prometheus Component">
<meta name="twitter:image:src" content="https://clydebarrow.github.io/esphome-docs/_images/prometheus.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up a prometheus exporter with ESPHome.">
<meta property="og:title" content="Prometheus Component">
<meta property="og:image" content="https://clydebarrow.github.io/esphome-docs/_images/prometheus.png">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for setting up a prometheus exporter with ESPHome.">

    <title>Prometheus Component &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://clydebarrow.github.io/esphome-docs/components/prometheus.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Remote Receiver" href="remote_receiver.html" />
    <link rel="prev" title="Power Supply Component" href="power_supply.html" />
  <link rel="stylesheet" href="../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
  <link rel="manifest" href="_static/site.webmanifest">
  <link rel="mask-icon" href="_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="pagefind/pagefind-ui.css" rel="stylesheet">
<script src="pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Prometheus Component</a><ul>
<li><a class="reference internal" href="#configuration-variables">Configuration variables:</a></li>
<li><a class="reference internal" href="#metric-relabeling">Metric Relabeling</a><ul>
<li><a class="reference internal" href="#relabel"><code class="docutils literal notranslate"><span class="pre">relabel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="index.html">Components</a> ➔</li>
      <li>Prometheus Component</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="prometheus-component">
<h1>Prometheus Component<a class="headerlink" href="#prometheus-component" title="Permalink to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">prometheus</span></code> component enables an HTTP endpoint for the
<a class="reference internal" href="web_server.html"><span class="doc">Web Server Component</span></a> in order to integrate a <a class="reference external" href="https://prometheus.io/">Prometheus</a> installation.</p>
<p>This can be used to scrape data directly into your Prometheus-based monitoring and alerting-system,
without the need of any other software.</p>
<p>The list of available metrics can be found by directly browsing your node under
<code class="docutils literal notranslate"><span class="pre">&lt;ip</span> <span class="pre">or</span> <span class="pre">node_name.local&gt;/metrics</span></code>, and may be increased in the future.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">web_server</span><span class="p">:</span>

<span class="c1"># Activates prometheus /metrics endpoint</span>
<span class="nt">prometheus</span><span class="p">:</span>
</pre></div>
</div>
<section id="configuration-variables">
<h2>Configuration variables:<a class="headerlink" href="#configuration-variables" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><strong>id</strong> (<em>Optional</em>, <a class="reference internal" href="../guides/configuration-types.html#config-id"><span class="std std-ref">ID</span></a>): Manually specify the ID used for code generation.</p></li>
<li><p><strong>include_internal</strong> (<em>Optional</em>, boolean): Whether <code class="docutils literal notranslate"><span class="pre">internal</span></code> entities should be displayed on the
web interface. Defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p></li>
<li><p><strong>relabel</strong> (<em>Optional</em>): Override metric labels. See <a class="reference internal" href="#prometheus-relabel"><span class="std std-ref">relabel</span></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Example integration into the configuration of your prometheus:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">scrape_configs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">job_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">esphome</span>
<span class="w">    </span><span class="nt">static_configs</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">&lt;ip or node_name.local&gt;</span><span class="p p-Indicator">]</span>
</pre></div>
</div>
</div>
</section>
<section id="metric-relabeling">
<h2>Metric Relabeling<a class="headerlink" href="#metric-relabeling" title="Permalink to this heading">¶</a></h2>
<p>ESPHome allows you to do some basic relabeling of Prometheus metrics.
This is useful if you want to have different metric names or IDs than those shown in Home Assistant or the web interface.</p>
<p>You can relabel metric name or ID labels by adding a <code class="docutils literal notranslate"><span class="pre">relabel</span></code> block in the <code class="docutils literal notranslate"><span class="pre">prometheus</span></code> configuration,
and then adding a block with <code class="docutils literal notranslate"><span class="pre">id</span></code> and/or <code class="docutils literal notranslate"><span class="pre">name</span></code> fields for each sensor whose labels your want to override.</p>
<section id="relabel">
<span id="prometheus-relabel"></span><h3><code class="docutils literal notranslate"><span class="pre">relabel</span></code><a class="headerlink" href="#relabel" title="Permalink to this heading">¶</a></h3>
<p>Set the <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code> label values of the Prometheus metric for the sensor with the specified ID.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example configuration entry</span>
<span class="nt">prometheus</span><span class="p">:</span>
<span class="w">  </span><span class="nt">relabel</span><span class="p">:</span>
<span class="w">    </span><span class="nt">my_voltage_sensor</span><span class="p">:</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">angry_pixies</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Angry</span><span class="nv"> </span><span class="s">Pixies&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="web_server.html"><span class="doc">Web Server Component</span></a></p></li>
<li><p><a class="reference internal" href="../web-api/index.html#api-rest"><span class="std std-ref">REST API</span></a></p></li>
<li><p><a class="reference internal" href="http_request.html"><span class="doc">HTTP Request</span></a></p></li>
<li><p><a class="reference external" href="/api/prometheus__handler_8h.html">API Reference</a></p></li>
<li><p><a class="reference external" href="https://prometheus.io/">Prometheus</a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/components/prometheus.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 🎉
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>