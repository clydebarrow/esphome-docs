
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for hacking your power meter at home to measure your power usage.">
<meta itemprop="name" content="Non-Invasive Power Meter">
<meta itemprop="description" content="Instructions for hacking your power meter at home to measure your power usage.">
<meta itemprop="image" content="https://clydebarrow.github.io/esphome-docs/_images/power_meter.jpg">
<meta name="twitter:title" content="Non-Invasive Power Meter">
<meta name="twitter:image:src" content="https://clydebarrow.github.io/esphome-docs/_images/power_meter.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for hacking your power meter at home to measure your power usage.">
<meta property="og:title" content="Non-Invasive Power Meter">
<meta property="og:image" content="https://clydebarrow.github.io/esphome-docs/_images/power_meter.jpg">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for hacking your power meter at home to measure your power usage.">

    <title>Non-Invasive Power Meter &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://clydebarrow.github.io/esphome-docs/cookbook/power_meter.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sonoff Fish Pond Pump" href="sonoff-fishpond-pump.html" />
    <link rel="prev" title="ESP32 Water Leak Detector (with notification)" href="leak-detector-m5stickC.html" />
  <link rel="stylesheet" href="../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
  <link rel="manifest" href="_static/site.webmanifest">
  <link rel="mask-icon" href="_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="pagefind/pagefind-ui.css" rel="stylesheet">
<script src="pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Non-Invasive Power Meter</a><ul>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="index.html">Cookbook</a> âž”</li>
      <li>Non-Invasive Power Meter</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="non-invasive-power-meter">
<h1>Non-Invasive Power Meter<a class="headerlink" href="#non-invasive-power-meter" title="Permalink to this heading">Â¶</a></h1>
<p>So an essential part of making your home smart is knowing how much power it uses over
the day. Tracking this can be difficult, often you need to install a completely new
power meter which can often cost a bunch of money. However, quite a few power meters
have a red LED on the front that blinks every time that one Wh has been used.</p>
<p>The simple idea therefore is: Why donâ€™t we just abuse that functionality to make the power-meter
IoT enabled? We just have to hook up a simple photoresistor in front of that aforementioned
LED and track the amount of pulses we receive. Then using ESPHome we can instantly have
the power meter show up in Home Assistant ðŸŽ‰</p>
<p>Hooking it all up is quite easy: Just buy a suitable photoresistor (make sure the wave length
approximately matches the one from your power meter). Then connect it using a simple variable
resistor divider (see <a class="reference external" href="https://blog.udemy.com/arduino-ldr/">this article</a> for inspiration).
Andâ€¦ that should already be it :)</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/power_meter-header.jpg"><img alt="../_images/power_meter-header.jpg" src="../_images/power_meter-header.jpg" style="width: 80.0%;" /></a>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some energy meters have an exposed S0 port (which essentially just is a switch that closes), if
that is the case the photodiode can be replaced with the following connection.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">S0 ------------ VCC</span>
<span class="l l-Scalar l-Scalar-Plain">S0 --+-- 10k -- GND</span>
<span class="l l-Scalar l-Scalar-Plain">.    |</span>
<span class="l l-Scalar l-Scalar-Plain">.    +--------- GPIO12</span>
</pre></div>
</div>
</div>
<p>For ESPHome, you can then use the
<a class="reference internal" href="../components/sensor/pulse_counter.html"><span class="doc">pulse counter sensor</span></a> using below configuration:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pulse_counter</span>
<span class="w">    </span><span class="nt">pin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GPIO12</span>
<span class="w">    </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;kW&#39;</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Power</span><span class="nv"> </span><span class="s">Meter&#39;</span>
<span class="w">    </span><span class="nt">filters</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">multiply</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.06</span><span class="w">  </span><span class="c1"># (60s/1000 pulses per kWh)</span>
</pre></div>
</div>
<p>Adjust <code class="docutils literal notranslate"><span class="pre">GPIO12</span></code> to match your set up of course. The output from the pulse counter sensor is in
<code class="docutils literal notranslate"><span class="pre">pulses/min</span></code> and we also know that 1000 pulses from the LED should equal 1kWh of power usage.
Thus, rearranging the expression yields a proportional factor of <code class="docutils literal notranslate"><span class="pre">0.06</span></code> from <code class="docutils literal notranslate"><span class="pre">pulses/min</span></code> to
<code class="docutils literal notranslate"><span class="pre">kW</span></code>.</p>
<p>And if a technician shows up and he looks confused about what the heck you have done to your
power meter, tell them about ESPHome ðŸ˜‰</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Photoresistors often have a bit of noise during their switching phases. So in certain situations,
a single power meter tick can result in many pulses being counted. This effect is especially big on
ESP8266s. If youâ€™re experiencing this, try enabling the <code class="docutils literal notranslate"><span class="pre">internal_filter:</span></code> filter option:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pulse_counter</span>
<span class="w">    </span><span class="c1"># ...</span>
<span class="w">    </span><span class="nt">internal_filter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10us</span>
</pre></div>
</div>
</div>
<p>See <a class="reference internal" href="../components/sensor/total_daily_energy.html"><span class="doc">Total Daily Energy Sensor</span></a> for counting up the total daily energy usage
with these <code class="docutils literal notranslate"><span class="pre">pulse_counter</span></code> power meters.</p>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">Â¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../components/sensor/pulse_counter.html"><span class="doc">Pulse Counter Sensor</span></a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/cookbook/power_meter.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 ðŸŽ‰
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>