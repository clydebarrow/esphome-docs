
  <!DOCTYPE html>


<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<meta name="description" content="Instructions for setting up BME280 sensors in ESPHome and calculate altitude, absolute humidity, and sea level pressure.">
<meta name="keywords" content="BME280">
<meta itemprop="name" content="BME280 Environment">
<meta itemprop="description" content="Instructions for setting up BME280 sensors in ESPHome and calculate altitude, absolute humidity, and sea level pressure.">
<meta itemprop="image" content="https://esphome.io/_images/bme280.jpg">
<meta name="twitter:title" content="BME280 Environment">
<meta name="twitter:image:src" content="https://esphome.io/_images/bme280.jpg">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@OttoWinter_">
<meta name="twitter:description" content="Instructions for setting up BME280 sensors in ESPHome and calculate altitude, absolute humidity, and sea level pressure.">
<meta property="og:title" content="BME280 Environment">
<meta property="og:image" content="https://esphome.io/_images/bme280.jpg">
<meta property="og:type" content="website">
<meta property="og:description" content="Instructions for setting up BME280 sensors in ESPHome and calculate altitude, absolute humidity, and sea level pressure.">

    <title>BME280 Environment &#8212; ESPHome</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../_static/pygments_dark.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="canonical" href="https://esphome.io/cookbook/bme280_environment.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time &amp; Temperature on OLED Display" href="display_time_temp_oled.html" />
    <link rel="prev" title="Arduino Port Expander" href="arduino_port_extender.html" />
  <link rel="stylesheet" href="../_static/custom.css?hash=ab494674" type="text/css" />
  <link rel="apple-touch-icon" sizes="180x180" href="/_static/apple-touch-icon.png">
  <link rel="shortcut icon" href="/_static/favicon.ico">
  <link rel="icon" type="image/png" sizes="512x512" href="/_static/favicon-512x512.png">
  <link rel="icon" type="image/png" sizes="256x256" href="/_static/favicon-256x256.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/_static/favicon-192x192.png">
  <link rel="icon" type="image/png" sizes="128x128" href="/_static/favicon-128x128.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/_static/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/_static/favicon-16x16.png">
  <link rel="manifest" href="/_static/site.webmanifest">
  <link rel="mask-icon" href="/_static/safari-pinned-tab.svg" color="#646464">
  <meta name="apple-mobile-web-app-title" content="ESPHome">
  <meta name="application-name" content="ESPHome">
  <meta name="msapplication-TileColor" content="#dfdfdf">
  <meta name="msapplication-config" content="/_static/browserconfig.xml">
  <meta name="theme-color" content="#dfdfdf">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta property="og:site_name" content="ESPHome">
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo-text.svg" alt="Logo"/>
            </a></p><link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>

<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>

  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">BME280 Environment</a><ul>
<li><a class="reference internal" href="#altitude-and-absolute-humidity">Altitude and absolute humidity:</a></li>
<li><a class="reference internal" href="#equivalent-sea-level-pressure">Equivalent sea level pressure:</a></li>
<li><a class="reference internal" href="#formula-explanation">Formula explanation</a></li>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>

  </div><hr />
<ul>
    <li><a href="https://discord.gg/KhAMKrd" target="_blank">Join the community</a></li>
    <li><a href="https://twitter.com/esphome_" target="_blank">Follow us on Twitter</a></li>
    <li><a href="https://github.com/esphome/esphome" target="_blank">Source Code</a></li>
    <li><a href="mailto:esphome@nabucasa.com">Contact</a> (no support!)</li>
</ul>
ESPHome is an open source project by <a href="https://www.nabucasa.com" target="_blank">Nabu Casa</a>
<ul>
    <li><a href="https://www.netlify.com" target="_blank">This site is powered by Netlify</a></li>
</ul>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
  
  <ul class="breadcrumbs">
      <li><a href="index.html">Cookbook</a> âž”</li>
      <li>BME280 Environment</li>
  </ul>
  


          <div class="body" role="main">
            
  <section id="bme280-environment">
<h1>BME280 Environment<a class="headerlink" href="#bme280-environment" title="Permalink to this heading">Â¶</a></h1>
<p>The <a class="reference internal" href="../components/sensor/bme280.html"><span class="doc">BME280 Temperature+Pressure+Humidity Sensor</span></a> is a simple temperature, humidity, and pressure sensor with communication over <a class="reference internal" href="../components/i2c.html#i2c"><span class="std std-ref">IÂ²C</span></a>.
With some simple math it is possible to either determine the height of the sensor, or the current pressure at sea level.
This guide can be applied to any sensor measuring temperature and pressure at the same time, like the
<a class="reference internal" href="../components/sensor/bmp280.html"><span class="doc">BMP280 Temperature+Pressure Sensor</span></a>, or <a class="reference internal" href="../components/sensor/bme680.html"><span class="doc">BME680 Temperature+Pressure+Humidity+Gas Sensor</span></a>.</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../_images/bme280-header.jpg"><img alt="../_images/bme280-header.jpg" src="../_images/bme280-header.jpg" style="width: 75.0%;" /></a>
</figure>
<p>The first step is to connect the sensor as described <a class="reference internal" href="../components/sensor/bme280.html"><span class="doc">here</span></a>.
After validating the sensor is working, we can proceed and add some formulas.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280</span>
<span class="w">    </span><span class="nt">temperature</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Temperature&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_temperature</span>
<span class="w">    </span><span class="nt">pressure</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Pressure&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_pressure</span>
<span class="w">    </span><span class="nt">humidity</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Relative</span><span class="nv"> </span><span class="s">Humidity&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_humidity</span>
<span class="w">    </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0x77</span>
<span class="w">    </span><span class="nt">update_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15s</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Altitude&quot;</span>
<span class="w">    </span><span class="nt">lambda</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">      </span><span class="no">const float STANDARD_SEA_LEVEL_PRESSURE = 1013.25; //in hPa, see note</span>
<span class="w">      </span><span class="no">return ((id(bme280_temperature).state + 273.15) / 0.0065) *</span>
<span class="w">        </span><span class="no">(powf((STANDARD_SEA_LEVEL_PRESSURE / id(bme280_pressure).state), 0.190234) - 1); // in meter</span>
<span class="w">    </span><span class="nt">update_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15s</span>
<span class="w">    </span><span class="nt">icon</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mdi:signal&#39;</span>
<span class="w">    </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;m&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">absolute_humidity</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Absolute</span><span class="nv"> </span><span class="s">Humidity&quot;</span>
<span class="w">    </span><span class="nt">temperature</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_temperature</span>
<span class="w">    </span><span class="nt">humidity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_humidity</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Dew</span><span class="nv"> </span><span class="s">Point&quot;</span>
<span class="w">    </span><span class="nt">lambda</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">      </span><span class="no">return (243.5*(log(id(bme280_humidity).state/100)+((17.67*id(bme280_temperature).state)/</span>
<span class="w">      </span><span class="no">(243.5+id(bme280_temperature).state)))/(17.67-log(id(bme280_humidity).state/100)-</span>
<span class="w">      </span><span class="no">((17.67*id(bme280_temperature).state)/(243.5+id(bme280_temperature).state))));</span>
<span class="w">    </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Â°C</span>
<span class="w">    </span><span class="nt">icon</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;mdi:thermometer-alert&#39;</span>
</pre></div>
</div>
<section id="altitude-and-absolute-humidity">
<h2>Altitude and absolute humidity:<a class="headerlink" href="#altitude-and-absolute-humidity" title="Permalink to this heading">Â¶</a></h2>
<p>The first block <code class="docutils literal notranslate"><span class="pre">sensor</span></code> starts with the normal bme280 sensor components <code class="docutils literal notranslate"><span class="pre">temperature</span></code>, <code class="docutils literal notranslate"><span class="pre">pressure</span></code>,
and <code class="docutils literal notranslate"><span class="pre">humidity</span></code> with each their own id.
After the bme280 sensor, a <a class="reference internal" href="../components/sensor/template.html"><span class="doc">Template Sensor</span></a> is defined to calculate the altitude in a lambda.
The variable <code class="docutils literal notranslate"><span class="pre">STANDARD_SEA_LEVEL_PRESSURE</span></code> (in hPa), should be filled in for your location.
The formula derived from <a class="reference external" href="https://github.com/finitespace/BME280/blob/master/src/EnvironmentCalculations.cpp">here</a>,
converts the currently measured pressure to the altitudes in meters including temperature compensation.</p>
<p>The second block uses the <a class="reference internal" href="../components/sensor/absolute_humidity.html"><span class="doc">Absolute Humidity</span></a> component which
converts the currently measured temperature and relative humidity to absolute humidity (grams/m^3).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calculating the altitude with the BME280 sensor accurately requires this value to be known at sea level for your location and day.</p>
<p>This can be achieved by replacing the global constant <code class="docutils literal notranslate"><span class="pre">STANDARD_SEA_LEVEL_PRESSURE</span></code> by for example
pulling this value live from the internet or a stationary sensor via MQTT.</p>
</div>
</section>
<section id="equivalent-sea-level-pressure">
<h2>Equivalent sea level pressure:<a class="headerlink" href="#equivalent-sea-level-pressure" title="Permalink to this heading">Â¶</a></h2>
<p>Calculating the sea level pressure with a statically mounted sensor can be used as reference for moving sensors as mentioned in the note above.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">sensor</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280</span>
<span class="w">    </span><span class="nt">temperature</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Temperature&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_temperature</span>
<span class="w">    </span><span class="nt">pressure</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Pressure&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_pressure</span>
<span class="w">    </span><span class="nt">humidity</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;BME280</span><span class="nv"> </span><span class="s">Relative</span><span class="nv"> </span><span class="s">Humidity&quot;</span>
<span class="w">      </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bme280_humidity</span>
<span class="w">    </span><span class="nt">address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0x77</span>
<span class="w">    </span><span class="nt">update_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15s</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">platform</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">template</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Equivalent</span><span class="nv"> </span><span class="s">sea</span><span class="nv"> </span><span class="s">level</span><span class="nv"> </span><span class="s">pressure&quot;</span>
<span class="w">    </span><span class="nt">lambda</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|-</span>
<span class="w">      </span><span class="no">const float STANDARD_ALTITUDE = 0.6; // in meters, see note</span>
<span class="w">      </span><span class="no">return id(bme280_pressure).state / powf(1 - ((0.0065 * STANDARD_ALTITUDE) /</span>
<span class="w">        </span><span class="no">(id(bme280_temperature).state + (0.0065 * STANDARD_ALTITUDE) + 273.15)), 5.257); // in hPa</span>
<span class="w">    </span><span class="nt">update_interval</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15s</span>
<span class="w">    </span><span class="nt">unit_of_measurement</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;hPa&#39;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For calculating the equivalent sea level pressure, the sensor needs to be mounted at a fixed altitude.
Therefore it is not possible to calculate altitude at the same time, and vice versa!</p>
</div>
</section>
<section id="formula-explanation">
<h2>Formula explanation<a class="headerlink" href="#formula-explanation" title="Permalink to this heading">Â¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Atmospheric_pressure#Altitude_variation">Altitude calculation</a></p></li>
<li><p><a class="reference external" href="https://carnotcycle.wordpress.com/2017/08/01/compute-dewpoint-temperature-from-rh-t/">Dew Point calculation</a></p></li>
</ul>
</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">Â¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../components/sensor/absolute_humidity.html"><span class="doc">Absolute Humidity</span></a></p></li>
<li><p><a class="reference internal" href="../components/sensor/template.html"><span class="doc">Template Sensor</span></a></p></li>
<li><p><a class="reference internal" href="../components/sensor/bme280.html"><span class="doc">BME280 Temperature+Pressure+Humidity Sensor</span></a></p></li>
<li><p><a class="reference external" href="https://github.com/esphome/esphome-docs/blob/current/cookbook/bme280_environment.rst">Edit this page on GitHub</a></p></li>
</ul>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
  <div id="upgrade-footer">
    A new version has been release since you last visited this page: 2023.8.3 ðŸŽ‰
    <div class="footer-button-container">
      <div role="button" id="upgrade-footer-dismiss" class="footer-button">Dismiss</div>
      <a id="upgrade-footer-changelog" class="footer-button" href="/changelog/2023.8.0.html">View Changelog</a>
    </div>
  </div>
  <script>
    var old = window.localStorage.getItem("version");
    if (old === null || window.location.pathname.lastIndexOf("/changelog/", 0) === 0) { window.localStorage.setItem("version", "2023.8");
    } else if (old !== "2023.8") {
      const footerEl = document.getElementById("upgrade-footer");
      footerEl.classList.add("not-hidden");
      footerEl.addEventListener('click', function () {
        window.localStorage.setItem("version", "2023.8");
        footerEl.classList.remove("not-hidden");
      });
    }
  </script>

  </body>
</html>